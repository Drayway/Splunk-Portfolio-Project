# Splunk Project: Investigating Coordinated Failed Logins

### Objective

To analyze raw log data from multiple servers to identify and report on a potential password-spraying attack.

### Tools Used

* **Splunk Enterprise:** For data ingestion, searching, and analysis.
* **SPL (Splunk Processing Language):** For querying and data manipulation.

### The Scenario

As a Junior Security Operations Center (SOC) Analyst, my task was to investigate suspicious authentication activity across the company's server environment, which includes three web servers (`www1`, `www2`, `www3`) and a mail server (`mailsv`). The goal was to determine if any login failures were part of a coordinated attack rather than isolated incidents.

### The Process

1.  **Data Ingestion:** Loaded historical security logs (`sourcetype="secure-2"`) from all four servers into Splunk for analysis.

2.  **Initial Search:** Filtered the data for all events containing the phrase `"Failed password"` to isolate relevant security events.

3.  **Field Extraction:** The original logs did not contain a clean `user` field. I used a regular expression (`rex`) to extract the targeted username from the raw log text following the words `"for "` or `"for invalid user "`.

4.  **Analysis & Reporting:** Wrote a final SPL query to count the failed login attempts for each user on each host, sorting the results to highlight the most targeted accounts.

#### **Final Splunk Query:**

```spl
sourcetype="secure-2" "Failed password"
| rex field=_raw "for (?:invalid user )?(?<user>\w+)"
| stats count by user, host
| sort -count

The Outcome & Security Insight
The final report revealed a clear pattern of a password-spraying attack. Numerous common accounts (like root, admin, and guest) were being targeted with a high volume of failed logins across all four servers simultaneously. This indicates a single attacker attempting to find a weak password on any machine in the network.

This analysis provides actionable intelligence for the security team, allowing them to:

Immediately lock the most targeted user accounts.

Block the source IP addresses of the attacks at the firewall.

Verify that no unauthorized access was successful.

Visual Evidence
Below is a screenshot of the final statistics table generated by the query, showing the top targeted user accounts.

Visual Evidence
Below is a screenshot of the final statistics table generated by the query, showing the top targeted user accounts.

![Splunk Final Result](https://github.com/user-attachments/assets/5cd922fa-1e05-4703-9cae-5b8b6ce375f4)


