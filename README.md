# Splunk Project: Investigating Coordinated Failed Logins

### Objective

To analyze raw log data from multiple servers to identify and report on a potential password-spraying attack.

### Tools Used

* **Splunk Enterprise:** For data ingestion, searching, and analysis.
* **SPL (Splunk Processing Language):** For querying and data manipulation.

### The Scenario

As a Junior Security Operations Center (SOC) Analyst, my task was to investigate suspicious authentication activity across the company's server environment, which includes three web servers (`www1`, `www2`, `www3`) and a mail server (`mailsv`). The goal was to determine if any login failures were part of a coordinated attack rather than isolated incidents.

### The Process

1.  **Data Ingestion:** Loaded historical security logs (`sourcetype="secure-2"`) from all four servers into Splunk for analysis.

2.  **Initial Search:** Filtered the data for all events containing the phrase `"Failed password"` to isolate relevant security events.

3.  **Field Extraction:** The original logs did not contain a clean `user` field. I used a regular expression (`rex`) to extract the targeted username from the raw log text following the words `"for "` or `"for invalid user "`.

4.  **Analysis & Reporting:** Wrote a final SPL query to count the failed login attempts for each user on each host, sorting the results to highlight the most targeted accounts.

#### **Final Splunk Query:**

```spl
sourcetype="secure-2" "Failed password"
| rex field=_raw "for (?:invalid user )?(?<user>\w+)"
| stats count by user, host
| sort -count

The Outcome & Security Insight
The final report revealed a clear pattern of a password-spraying attack. Numerous common accounts (like root, admin, and guest) were being targeted with a high volume of failed logins across all four servers simultaneously. This indicates a single attacker attempting to find a weak password on any machine in the network.

This analysis provides actionable intelligence for the security team, allowing them to:

Immediately lock the most targeted user accounts.

Block the source IP addresses of the attacks at the firewall.

Verify that no unauthorized access was successful.

Visual Evidence
Below is a screenshot of the final statistics table generated by the query, showing the top targeted user accounts.


![Splunk Final Result](https://github.com/user-attachments/assets/21c1ae50-d3e0-484a-855d-b5b384535e30)



---

## Project 2: E-commerce Web Traffic & Customer Behavior Analysis (Business Analytics)

### **Objective**
To analyze web access logs for an e-commerce site to derive actionable business intelligence regarding product popularity and customer geography.

### **Tools Used**
* **Splunk Enterprise**
* **SPL Commands:** `top`, `iplocation`, `geostats`
* **Visualizations:** Choropleth Map

### **The Process**
1.  **Product Analysis:** Used the `top` command on the `access_combined_wcookie` sourcetype to identify the most frequently viewed products (`uri_path="/product.screen*"`) and the most frequently cart-added products (`action=addtocart`).
2.  **Geographic Analysis:** Leveraged the `iplocation` command to enrich web logs with geographic data based on visitor IP addresses.
3.  **Visualization:** Used the `geostats` command and a Choropleth map visualization to display the geographic distribution of the customer base by country.

#### **Final Splunk Queries:**
* **Most Viewed Products:**
    `sourcetype="access_combined_wcookie" uri_path="/product.screen*" | top limit=10 productId`
* **Most Cart-Added Products:**
    `sourcetype="access_combined_wcookie" action=addtocart | top limit=10 productId`
* **Customer Location Map:**
    `sourcetype="access_combined_wcookie" | iplocation clientip | geostats count by Country`

### **Outcome & Business Insight**
Delivered a multi-part report identifying the top 10 most popular products, which directly informs marketing and inventory decisions. Also provided a world map visualizing the global customer footprint, allowing the business to target specific regions for marketing campaigns.

### **Visual Evidence**
*A screenshot of the Choropleth map showing customer locations.*

![Splunk Project 2 Column Chart](https://github.com/user-attachments/assets/352faede-5aff-4e71-85a7-ff359b7d6a6f)
